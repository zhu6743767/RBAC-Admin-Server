# ================================================
# RBAC管理员服务器 - 主配置文件
# 支持环境变量替换和配置验证
# ================================================

# 🖥️ 服务器配置
system:
  ip: 127.0.0.1               # 服务IP地址
  port: 8090                  # 服务端口（与rbacAdmin保持一致）
  mode: "debug"               # 运行模式: debug, release

# 🗄️ 数据库配置
db:
  mode: "mysql"                # 数据库类型: mysql, postgres, sqlite
  host: "127.0.0.1"           # 数据库主机
  port: 3306                  # 数据库端口
  user: "root"                 # 数据库用户名
  password: "admin123"         # 数据库密码
  dbname: "rbac_admin"         # 数据库名称
  max_open_conns: 100         # 最大连接数
  max_idle_conns: 10          # 空闲连接数
  conn_max_lifetime: 3600     # 连接生命周期(秒)

# 🔄 Redis配置
redis:
  addr: "${REDIS_ADDR:127.0.0.1:6379}"          # Redis地址
  password: "${REDIS_PASSWORD}"                 # Redis密码
  db: ${REDIS_DB:3}                        # Redis数据库编号（与rbacAdmin保持一致）
  pool_size: 20                # 连接池大小
  min_idle_conns: 5            # 最小空闲连接数

# 📝 日志配置
log:
  level: "info"                # 日志级别: debug, info, warn, error
  format: "text"               # 日志格式: json, text
  stdout: true                 # 输出到标准输出
  dir: "./logs"                # 日志目录
  max_size: 100                # 最大文件大小(MB)
  max_backups: 3               # 最大备份文件数
  max_age: 7                   # 最大保存天数
  compress: true               # 是否压缩旧日志
  enable_caller: true          # 是否启用调用者信息

# 🔐 JWT认证配置
jwt:
  secret: "${JWT_SECRET:aB3kL9mN7xY2qR8sT1uV4wE6zC0pF5gH}"  # JWT密钥 (大小写字母+数字组合)
  expire_hours: 72                            # Token过期时间(小时)（与rbacAdmin保持一致）
  refresh_expire_hours: 168                   # 刷新Token过期时间(小时)
  issuer: "rbacAdmin"                         # Token签发者（与rbacAdmin保持一致）
  audience: "rbac-client"                     # Token受众

# 📧 邮箱配置
email:
  user: "${EMAIL_USER}"  # 发送者邮箱地址
  password: "${EMAIL_PASSWORD}"  # 授权密码
  host: smtp.qq.com  # 邮箱服务器
  port: 465  # 端口

captcha:
    enable: true
    width: 120
    height: 40
    length: 4
    expire_seconds: 300

# 📊 监控配置
monitoring:
  enabled: true
  prometheus_port: 9090
  health_check_path: /health
  metrics_path: /metrics
  trace_sampling_rate: 0.1

# 🌐 CORS配置
cors:
  enable: true                 # 是否启用CORS
  allow_origins:               # 允许的来源
    - "http://localhost:3000"
    - "http://localhost:8080"
  allow_methods:               # 允许的HTTP方法
    - "GET"
    - "POST"
    - "PUT"
    - "DELETE"
    - "OPTIONS"
  allow_headers:               # 允许的HTTP头
    - "Origin"
    - "Content-Type"
    - "Authorization"
  allow_credentials: true      # 是否允许凭证
  max_age: 3600                # 预检请求缓存时间

# 🔒 安全配置
security:
  enable_csrf: false           # 是否启用CSRF保护
  rate_limit: 100              # 每分钟请求限制
  xss_protection: true         # 是否启用XSS保护
  content_security_policy: "default-src 'self'"

# ⚡ 性能配置
performance:
  enable_gzip: true            # 是否启用Gzip压缩
  cache_size: 100              # 缓存大小(MB)

# 📤 上传配置
upload:
  enable: true                 # 是否启用文件上传
  max_size: 10                 # 最大文件大小(MB)
  save_path: "./uploads"       # 文件保存路径
  allow_types:                 # 允许的文件类型
    - "image/jpeg"
    - "image/png"
    - "application/pdf"

# 📚 Swagger配置
swagger:
  enable: true                 # 是否启用Swagger
  path: "/swagger/"            # Swagger路径
  title: "RBAC管理员系统API"     # Swagger标题
  description: "RBAC权限管理系统API文档"
  version: "1.0.0"             # API版本

# 📱 应用配置
app:
  name: "RBAC管理员系统"
  version: "1.0.0"
  description: "企业级RBAC权限管理解决方案"
  copyright: "© 2024 RBAC管理员系统团队"
