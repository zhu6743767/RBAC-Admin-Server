# =================================================================================
# 🏗️ RBAC管理员服务器 - 生产环境配置
# =================================================================================
# 📋 生产环境特性：
#   - 最高安全级别，所有敏感信息使用环境变量
#   - 性能优化配置，支持高并发
#   - 完整监控和告警配置
#   - 严格的访问控制和安全策略
#   - 生产级日志配置和备份策略
# =================================================================================

# 系统配置
system:
  ip: ${SYSTEM_IP:-127.0.0.1}    # 监听IP，通过环境变量配置
  port: ${SYSTEM_PORT:-8080}      # 生产环境端口，通过环境变量配置

# 数据库配置 - 生产环境使用环境变量
# 所有敏感信息必须通过环境变量配置
db:
  mode: "mysql"                 # 生产环境使用MySQL
  host: ${DB_HOST:-192.168.10.199}  # 数据库主机（环境变量，默认为192.168.10.199）
  port: ${DB_PORT:-3306}         # 数据库端口
  user: ${DB_USERNAME:-root}      # 数据库用户名（环境变量，默认为root）
  password: ${DB_PASSWORD}        # 数据库密码（环境变量）
  dbname: ${DB_NAME:-rbacadmin}  # 数据库名称（环境变量，默认为rbacadmin）
  max_open_conns: 200           # 生产环境高并发连接数
  max_idle_conns: 50
  conn_max_lifetime: 8h         # 生产环境长连接生命周期
  conn_max_idle_time: 1h
  ssl_mode: "require"           # 生产环境强制SSL
  timeout: "30s"

# 🔐 JWT配置 - 生产环境使用强密钥
jwt:
  secret: ${JWT_SECRET}         # JWT密钥（环境变量，必须设置）
  expire_hours: 24              # 生产环境标准有效期
  refresh_expire_hours: 168     # 7天刷新有效期
  issuer: ${JWT_ISSUER:-rbac-admin}    # 令牌颁发者
  audience: ${JWT_AUDIENCE:-rbac-admin}  # 令牌受众

# Redis配置 - 生产环境使用集群或哨兵
redis:
  addr: ${REDIS_ADDR:-192.168.10.199:6379}  # Redis地址（环境变量，默认为192.168.10.199:6379）
  password: ${REDIS_PASSWORD}     # Redis密码（环境变量）
  db: ${REDIS_DB:-4}              # Redis数据库编号（环境变量，默认为4）
  pool_size: 500                  # 生产环境大连接池
  min_idle_conns: 50
  max_conn_age: 1h
  dial_timeout: 10s
  read_timeout: 5s
  write_timeout: 5s

# 📝 日志配置 - 生产环境完整日志策略
log:
  level: ${LOG_LEVEL:-info}      # 日志级别（环境变量）
  format: "json"                 # JSON格式便于日志收集
  output: "both"                 # 同时输出到stdout和文件
  log_dir: ${LOG_DIR:-/var/log/rbac-admin}  # 生产环境日志目录
  max_size: 100                  # 生产环境大文件
  max_age: 30                    # 保留30天
  max_backups: 10              # 保留10个备份
  compress: true                 # 压缩节省空间
  enable_caller: true
  enable_trace: true

# ⚡ 性能配置 - 生产环境优化配置
performance:
  enable_pprof: false           # 生产环境关闭性能分析
  max_upload_size: "50MB"        # 生产环境合理上传限制
  request_rate_limit: 1000      # 生产环境合理限流
  burst_rate_limit: 2000
  enable_compression: true      # 生产环境启用压缩
  compression_level: 6        # 平衡压缩率和性能

# 📂 文件上传配置
upload:
  max_file_size: "50MB"         # 生产环境标准限制
  allowed_extensions: [".jpg", ".jpeg", ".png", ".gif", ".pdf", ".doc", ".docx"]
  allowed_mime_types: 
    - "image/jpeg"
    - "image/png"
    - "image/gif"
    - "application/pdf"
    - "application/msword"
    - "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
  storage_type: "local"         # 生产环境可配置为云存储
  storage_path: ${UPLOAD_DIR:-/var/uploads/rbac-admin}  # 上传目录
  max_files_per_request: 5

# 🔍 监控配置 - 生产环境完整监控
monitoring:
  enable_health_check: true
  health_check_path: "/health"
  enable_metrics: true
  metrics_path: "/metrics"
  enable_tracing: ${ENABLE_TRACING:-false}  # 生产环境可选链路追踪
  tracing_endpoint: ${TRACING_ENDPOINT:-http://jaeger:14268/api/traces}

# 🌐 CORS配置 - 生产环境严格配置
cors:
  enable: true
  allow_origins: ${CORS_ORIGINS:-https://admin.rbac-system.com}  # 生产环境指定域名
  allow_methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
  allow_headers: 
    - "Content-Type"
    - "Authorization"
    - "X-Requested-With"
    - "X-API-Key"
  allow_credentials: true
  max_age: 1h

# 🔒 安全配置 - 生产环境最高安全级别
security:
  bcrypt_cost: 14              # 生产环境使用最高安全级别
  max_login_attempts: 5        # 生产环境标准限制
  lock_duration_minutes: 30     # 生产环境标准锁定
  session_timeout: 2h          # 生产环境适中会话
  api_key_header: "X-API-Key"
  enable_csrf: true            # 生产环境启用CSRF保护
  csrf_secret: ${CSRF_SECRET}  # CSRF密钥（环境变量）

# 📚 Swagger配置 - 生产环境可选
swagger:
  enable: ${ENABLE_SWAGGER:-false}  # 生产环境默认关闭Swagger
  title: "RBAC管理员API - 生产环境"
  description: "RBAC管理员服务器API文档 - 生产环境"
  version: "1.0.0"
  host: ${SWAGGER_HOST:-api.rbac-system.com}
  base_path: "/api/v1"
  enable_ui: false              # 生产环境关闭Swagger UI

# 🎯 应用配置
app:
  name: "RBAC管理员"
  version: "1.0.0"
  environment: "production"
  debug: false